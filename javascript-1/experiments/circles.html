<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="robots" content="noindex, nofollow">
    <meta name="author" content="Alexander Shatalov">
	<title>Alexander Shatalov > JavaScript 1 > Circles (19/05/2017)</title>
</head>
<body style="background-color: #ffffff;">
	<p id="text" style="font-size: 14px; color: silver;">Для остановки скрипта нажмите клавишу "ESC"</p>
</body>
<script>
	var times = 0,
		diameter = 0,
		transition = false;

	function createCircle() {
		if (transition) {
			var circle = document.getElementById('circle' + times);
			circle.style.width = diameter + 'px';
			circle.style.height = circle.style.width;
			transition = false;
			// количество повторов до остановки
			if (times++ > 30) {
				circle = document.getElementById('circle' + (times - 32));
				circle.style.transition = '2s';
				circle.style.width = '0px';
				// circle.style.left = 0 + 'px';
				circle.style.top = 0 + 'px';
				circle.style.height = circle.style.width;
				// circle.parentNode.removeChild(circle); // удаление элемента
			}
			if (times > 1000) {
				clearInterval(numInterval);
			}
		} else {
			var circle = document.createElement('div');
				diameter = Math.floor(Math.random()*110) + 10, // Диаметр круга
				windowHeight = window.innerHeight, // Возвращает высоту области просмотра окна.
				windowWidth = window.innerWidth, // Возвращает ширину области просмотра окна.
				x = Math.floor(Math.random()*(windowWidth-diameter*2))+diameter,
				y = Math.floor(Math.random()*(windowHeight-diameter*2))+diameter,
				r = Math.floor(Math.random()*255),
				g = Math.floor(Math.random()*255),
				b = Math.floor(Math.random()*255),
				colors = ['red', 'blue', 'green', 'orange', 'aqua', 'violet', 'black', 'gray']; // Палитра цветов
			circle.id = 'circle' + times;
			circle.style.position = 'absolute';
			circle.style.borderRadius = Math.floor(Math.random()*40) + 10 + '%';
			// circle.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
			circle.style.backgroundColor = 'rgb(' + r + ',' + g + ',' + b + ')';
			circle.style.left = x + 'px';
			circle.style.top = y + 'px';
			circle.style.width = '1px';
			circle.style.height = circle.style.width;
			circle.style.transition = '.7s';
			// circle.innerHTML = times;
			document.body.appendChild(circle);
			transition = true;
			// document.getElementById('text').style.color = circle.style.backgroundColor;
		}

	}

	numInterval = setInterval(function(){ createCircle(); }, 50)

	// Ожидание нажатия клавиши ESC
	window.captureEvents(Event.KEYPRESS);
	window.onkeypress = pressed;
    function pressed(e) {
        // alert("Нажата клавиша, ее значение ASCII: " + e.which);
        if(e.keyCode == 27) {
	        console.log (e);
	        clearInterval(numInterval);
        }
    }

</script>
</html>