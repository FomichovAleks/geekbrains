function Container(){this.id="",this.className="",this.htmlCode=""}function Carousel(){Container.call(this,"carousel"),this.widthCarousel=0,this.currency="",this.leftString=0,this.productsSlide=0,this.productsFirst=1,this.countProducts=0,this.productsItems=[],this.widthCarouselNav=function(){return $(".carousel__nav").width()},this.widthProduct=function(){return $(".carousel__products-container").width()+20},this.widthString=function(){var t=this.widthProduct()*this.countProducts;return $(".carousel__products-string").css({width:t}),t},this.loadCarouselItems(),this.render(),this.renderDots(),this.productsBasket=[],this.delBasket(),this.amountBasket(),this.totalBasket(),this.renderBasket(),this.keyDown(),this.arrows()}Container.prototype.render=function(){return this.htmlCode},Carousel.prototype=Object.create(Container.prototype),Carousel.prototype.constructor=Carousel,Carousel.prototype.arrows=function(t){"right"==t?(this.leftString-=this.widthProduct(),this.productsFirst++):"left"==t?(this.leftString+=this.widthProduct(),this.productsFirst--):isNaN(t)||(this.leftString=-(t-1)*this.productsSlide*this.widthProduct(),this.productsFirst=t*this.productsSlide),this.leftString>0&&(this.leftString=0,this.productsFirst=1),this.leftString<this.widthProduct()*this.productsSlide-this.widthString()&&(this.leftString=this.widthProduct()*this.productsSlide-this.widthString(),this.productsFirst=this.countProducts-this.productsSlide+1),$(".carousel__products-string").css({left:this.leftString}),this.renderDots(".carousel__dots-items")},Carousel.prototype.render=function(t){$(".carousel").css({width:this.widthCarousel}),this.widthCarouselNav(),this.widthProduct(),this.widthString(),$(t).empty();for(var s in this.productsItems){var e="carousel__products-container_"+s,a=$("<div />",{class:"carousel__products-container",id:e});a.appendTo(t),$("#"+e).draggable({revert:"invalid",helper:function(){return $(this).clone()},appendTo:"body",scroll:!1,start:function(){$(this).css({opacity:0})},stop:function(){$(this).css({opacity:100})}});var r=$("<div />",{class:"carousel__products-items"});r.appendTo(a);var o="carousel__products-items-images_"+s;$("<div />",{class:"carousel__products-items-images",id:o,style:"background-image: url("+this.productsItems[s].image+")"}).appendTo(r),$("<div />",{class:"carousel__products-items-titles",text:this.productsItems[s].title}).appendTo(r),$("<div />",{class:"carousel__products-items-descriptions",text:this.productsItems[s].description}).appendTo(r),$("<div />",{class:"carousel__products-items-prices",text:this.productsItems[s].price+this.currency}).appendTo(r),$("<div />",{class:"carousel__products-items-basket",text:"В корзину"}).appendTo(r)}},Carousel.prototype.renderDots=function(t){var s=this;$(t).empty();for(var e=1;e<=this.countProducts/this.productsSlide;++e){var a="";Math.ceil(this.productsFirst/this.productsSlide)==e&&(a=" carousel__dots-items-links-rounds_active");var r=$("<span />",{class:"carousel__dots-items-links"});r.appendTo(t);var o="carousel__dots-items-links-rounds_"+e;$("<span />",{id:o,class:"carousel__dots-items-links-rounds"+a}).appendTo(r),$("#"+o).on("click",function(){s.arrows($(this).attr("id").split("_")[3])})}},Carousel.prototype.renderBasket=function(t){var s=this;if($(t).empty(),this.productsBasket.length>0){$(t).css({display:"table"});var e=$("<div />",{class:"basket__table-row basket__table-row_header"});e.appendTo(t);var a="basket__table-cell basket__table-cell_numbers",r=$("<span />",{class:a,text:"№"});r.appendTo(e);var o="basket__table-cell basket__table-cell_titles",i=$("<span />",{class:o,text:"Наименование"});i.appendTo(e);var l="basket__table-cell basket__table-cell_photos",c=$("<span />",{class:l,text:"Фото"});c.appendTo(e);var n="basket__table-cell basket__table-cell_descriptions",d=$("<span />",{class:n,text:"Описание"});d.appendTo(e);var p="basket__table-cell basket__table-cell_prices",u=$("<span />",{class:p,text:"Цена"});u.appendTo(e);var _="basket__table-cell basket__table-cell_amount",h=$("<span />",{class:_,text:"Кол-во"});h.appendTo(e);var b="basket__table-cell basket__table-cell_count",k=$("<span />",{class:b,text:"Сумма"});k.appendTo(e);var m="basket__table-cell basket__table-cell_del",v=$("<span />",{class:m,text:"Операция"});v.appendTo(e);for(var f in this.productsBasket){var y=this.productsBasket[f].number,g=$("<div />",{class:"basket__table-row basket__table-row_products"});g.appendTo(t),a="basket__table-cell basket__table-cell_numbers",(r=$("<span />",{class:a})).appendTo(g),o="basket__table-cell basket__table-cell_titles",(i=$("<span />",{class:o,text:this.productsItems[y].title})).appendTo(g),l="basket__table-cell basket__table-cell_photos",(c=$("<span />",{class:l,style:"background-image: url("+this.productsItems[y].image+")"})).appendTo(g),n="basket__table-cell basket__table-cell_descriptions",(d=$("<span />",{class:n,text:this.productsItems[y].description})).appendTo(g);var w=this.productsItems[y].price;p="basket__table-cell basket__table-cell_prices",(u=$("<span />",{class:p,text:w+this.currency})).appendTo(g),_="basket__table-cell basket__table-cell_amount",(h=$("<span />",{class:_,text:""})).appendTo(g);var T=this.productsBasket[f].count,B="basket__table-cell_amount-input_"+y;$("<input />",{id:B,class:"basket__table-cell_amount-input",maxlength:2,type:"number",min:1,max:10,value:T}).appendTo(h),$("#"+B).on("click keyup input",function(){this.value.length>this.maxLength?this.value=this.value.slice(0,this.maxLength):s.amountBasket(this.id)});var C="basket__table-cell_count_"+y;b="basket__table-cell basket__table-cell_count",(k=$("<span />",{id:C,class:b,text:w*T+this.currency})).appendTo(g),m="basket__table-cell basket__table-cell_del",(v=$("<span />",{class:m})).appendTo(g);var x="basket__table-cell_del-button_"+y;$("<span />",{class:"basket__table-cell_del-button",id:x,text:"Удалить"}).appendTo(v),$("#"+x).on("click",function(){s.delBasket(this.id)})}var S=$("<div />",{class:"basket__table-row basket__table-row_sum"});S.appendTo(t);for(var I=1;I<=7;I++){$("<span />",{class:"basket__table-cell",html:"&nbsp;"}).appendTo(S)}$("<span />",{class:"basket__table-cell basket__table-cell_total",text:this.totalBasket()}).appendTo(S)}else $(t).css({display:"none"})},Carousel.prototype.totalBasket=function(){var t=0;for(var s in this.productsBasket){var e=this.productsBasket[s].number;t+=this.productsItems[e].price*this.productsBasket[s].count}return"ИТОГО: "+t+this.currency},Carousel.prototype.amountBasket=function(t){if("string"==typeof t){var s=$("#"+t).val(),e=t.split("_")[4],a=this.productsItems[e].price*s+this.currency;for(var r in this.productsBasket)this.productsBasket[r].number==e&&(this.productsBasket[r].count=s);$("#basket__table-cell_count_"+e).text(a),$(".basket__table-cell_total").text(this.totalBasket())}},Carousel.prototype.delBasket=function(t){if("string"==typeof t){var s=t.split("_")[4];for(var e in this.productsBasket)this.productsBasket[e].number==s&&this.productsBasket.splice(e,1);$("#"+t).parent().parent().remove(),this.renderBasket(".basket__table")}},Carousel.prototype.loadCarouselItems=function(){$.get({url:"./json/carousel.json",dataType:"json",error:function(){console.log("JSON load: Error!")},success:function(t){console.log("JSON-file load: Ок!"),this.widthCarousel=t.widthCarousel,this.productsSlide=t.productsSlide,this.currency=t.currency,this.countProducts=t.products.length;for(var s in t.products)this.productsItems.push(t.products[s]);this.render(".carousel__products-string"),this.renderDots(".carousel__dots-items"),this.renderBasket(".basket__table"),$(".carousel").css({opacity:100})},context:this})},Carousel.prototype.keyDown=function(){var t=this,s={37:"left",39:"right"};$("body").on("keydown",function(e){e.keyCode in s&&t.arrows(s[e.keyCode])})},$(document).ready(function(){var t=new Carousel;$(".carousel__nav-arrows-links_left").on("click",function(){t.arrows("left")}),$(".carousel__nav-arrows-links_right").on("click",function(){t.arrows("right")}),$(".basket").droppable({drop:function(s,e){$(".basket").css("border","solid 1px white");var a=e.draggable[0].id,r=$("#"+a).attr("id").split("_")[3],o=!1;for(var i in t.productsBasket)t.productsBasket[i].number==r&&(o=!0,t.productsBasket[i].count++);o||t.productsBasket.push({number:parseInt(r),count:1}),t.renderBasket(".basket__table")},over:function(t,s){$(".basket").css("border","solid 1px #007DC7")},out:function(t,s){$(".basket").css("border","solid 1px white")}})});